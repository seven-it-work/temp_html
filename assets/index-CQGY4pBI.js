import{i as N}from"./interact.min-BBxEDMb4.js";import{d as S,i as $,D as k,j as P,k as T,c as u,v as z,s as w,o as p,_ as I,K as A,a as r,F as g,r as y,L as B,h as f}from"./index-uW7zrAKI.js";const J=["data-x","data-y","data-position-type"],O=S({__name:"CardSlot",props:{positionType:{},cardId:{}},emits:["drag-start","drag-end","card-move"],setup(C,{emit:_}){const e=C,n=_,d=$({x:0,y:0}),s=$({x:0,y:0}),l=$(e.positionType),c=$(null);let i=null;return k(()=>e.positionType,(t,o)=>{t!==o&&(d.value={x:0,y:0})}),P(()=>{const t=c.value;t&&(i=N(t).draggable({inertia:!0,autoScroll:!1,cursorChecker(){return"grabbing"},listeners:{start(o){const a=o.target;s.value={...d.value},l.value=e.positionType,console.log(`[拖拽开始] 卡片: ${e.cardId}, 初始位置类型: ${l.value}, 初始坐标: (${s.value.x}, ${s.value.y})`),n("drag-start",e.cardId),a.style.zIndex="2000",a.style.opacity="0.8",a.style.transition="none"},move(o){d.value.x+=o.dx,d.value.y+=o.dy,console.log(`[拖拽移动] 卡片: ${e.cardId}, 移动距离: (${o.dx}, ${o.dy}), 新坐标: (${d.value.x}, ${d.value.y})`)},end(o){const a=o.target,h=o.clientX,x=o.clientY;console.log(`[拖拽结束] 卡片: ${e.cardId}, 释放屏幕坐标: (${h}, ${x})`);const E=document.querySelectorAll(".game-section.hand-section");let m=!1,D=[];for(const M of E){const v=M.getBoundingClientRect();if(D.push(v),console.log(`[区域检查] 手牌区域坐标: 左=${v.left}, 右=${v.right}, 上=${v.top}, 下=${v.bottom}`),h>=v.left&&h<=v.right&&x>=v.top&&x<=v.bottom){m=!0,console.log(`[区域检查] 卡片 ${e.cardId} 释放到手牌区域内`);break}}m||(console.log(`[区域检查] 卡片 ${e.cardId} 释放到非手牌区域`),console.log("[区域检查] 释放点不在任何手牌区域内，手牌区域信息:",D)),n("drag-end",e.cardId,m?"hand":null),m?(console.log(`[位置更新] 卡片 ${e.cardId} 从 ${l.value} 移动到手牌区域`),n("card-move",e.cardId,l.value,"手牌"),d.value={x:0,y:0},console.log(`[位置更新] 卡片 ${e.cardId} 位置重置为 (0, 0)`)):(console.log(`[位置更新] 卡片 ${e.cardId} 回到初始位置: (${s.value.x}, ${s.value.y})`),d.value={...s.value}),a.style.zIndex="",a.style.opacity="1",a.style.transition="transform 0.1s ease, opacity 0.2s ease"}}}))}),T(()=>{i&&i.unset()}),(t,o)=>(p(),u("div",{ref_key:"cardRef",ref:c,class:w(["card-slot",`position-${e.positionType}`]),"data-x":d.value.x,"data-y":d.value.y,"data-position-type":e.positionType,style:z({transform:`translate(${d.value.x}px, ${d.value.y}px)`})},null,14,J))}}),b=I(O,[["__scopeId","data-v-9efa6e58"]]),R={class:"vertical-hearthstone"},V={class:"game-container"},F={class:"game-section tavern-section"},L={class:"card-row"},X={class:"card-row"},Y={class:"game-section battlefield-section"},j={class:"card-row"},q={class:"card-row"},H={class:"card-row"},K={class:"card-row"},U=S({__name:"index",setup(C){const _=$(!1),e=$(null),n=A({});(()=>{for(let t=1;t<=5;t++)n[`tavern-1-${t}`]="酒馆";for(let t=1;t<=2;t++)n[`tavern-2-${t}`]="酒馆";for(let t=1;t<=5;t++)n[`battlefield-1-${t}`]="战场";for(let t=1;t<=2;t++)n[`battlefield-2-${t}`]="战场";for(let t=1;t<=5;t++)n[`hand-1-${t}`]="手牌";for(let t=1;t<=5;t++)n[`hand-2-${t}`]="手牌"})();const s=t=>n[t]||"酒馆",l=t=>{_.value=!0,e.value=t,console.log(`[父组件] 开始拖拽卡片: ${t}, 当前位置: ${s(t)}`)},c=(t,o)=>{console.log(`[父组件] 拖拽结束: 卡片 ${t}, 目标区域: ${o||"非手牌区域"}`),_.value=!1,e.value=null},i=(t,o,a)=>{console.log(`[父组件] 卡片移动事件: 卡片 ${t} 从 ${o} 移动到 ${a}`);const h=n[t];n[t]=a,console.log(`[父组件] 卡片位置更新: 卡片 ${t} 位置从 ${h} 变为 ${n[t]}`),console.log("[父组件] 当前所有卡片位置:",JSON.parse(JSON.stringify(n)))};return k(()=>JSON.parse(JSON.stringify(n)),(t,o)=>{console.log("[父组件] 卡片位置映射变化: 旧位置:",o,"新位置:",t)},{deep:!0}),(t,o)=>(p(),u("div",R,[r("div",V,[r("div",F,[r("div",L,[(p(),u(g,null,y(5,a=>f(b,{key:"tavern-1-"+a,"card-id":"tavern-1-"+a,"position-type":s("tavern-1-"+a),onDragStart:l,onDragEnd:c,onCardMove:i},null,8,["card-id","position-type"])),64))]),r("div",X,[(p(),u(g,null,y(2,a=>f(b,{key:"tavern-2-"+a,"card-id":"tavern-2-"+a,"position-type":s("tavern-2-"+a),onDragStart:l,onDragEnd:c,onCardMove:i},null,8,["card-id","position-type"])),64)),o[0]||(o[0]=B('<div class="info-panel tavern-info" data-v-0cb2942d><div class="stats-row" data-v-0cb2942d><div data-v-0cb2942d>酒馆等级：1级</div><button data-v-0cb2942d>升级(1)</button></div><div class="buttons-row" data-v-0cb2942d><div data-v-0cb2942d>第x回合</div><button data-v-0cb2942d>刷新(1)</button><button data-v-0cb2942d>冻结(0)</button></div><div class="stats-row" data-v-0cb2942d><div data-v-0cb2942d>生命值：30 护甲：7</div><button data-v-0cb2942d>技能</button></div><div class="buttons-row" data-v-0cb2942d><div data-v-0cb2942d>铸币：10/10</div><button data-v-0cb2942d>设置</button><button data-v-0cb2942d>调试</button></div></div>',1))])]),r("div",Y,[r("div",j,[(p(),u(g,null,y(5,a=>f(b,{key:"battlefield-1-"+a,"card-id":"battlefield-1-"+a,"position-type":s("battlefield-1-"+a),onDragStart:l,onDragEnd:c,onCardMove:i},null,8,["card-id","position-type"])),64))]),r("div",q,[(p(),u(g,null,y(2,a=>f(b,{key:"battlefield-2-"+a,"card-id":"battlefield-2-"+a,"position-type":s("battlefield-2-"+a),onDragStart:l,onDragEnd:c,onCardMove:i},null,8,["card-id","position-type"])),64)),o[1]||(o[1]=r("div",{class:"info-panel player-info"},[r("div",null,"选中的卡片信息")],-1))])]),r("div",{class:w(["game-section hand-section",{"drop-allowed":_.value}])},[r("div",H,[(p(),u(g,null,y(5,a=>f(b,{key:"hand-1-"+a,"card-id":"hand-1-"+a,"position-type":s("hand-1-"+a),onDragStart:l,onDragEnd:c,onCardMove:i},null,8,["card-id","position-type"])),64))]),r("div",K,[(p(),u(g,null,y(5,a=>f(b,{key:"hand-2-"+a,"card-id":"hand-2-"+a,"position-type":s("hand-2-"+a),onDragStart:l,onDragEnd:c,onCardMove:i},null,8,["card-id","position-type"])),64))])],2)])]))}}),W=I(U,[["__scopeId","data-v-0cb2942d"]]);export{W as default};
